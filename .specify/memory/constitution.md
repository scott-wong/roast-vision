<!--
Sync Impact Report
- Version: 0.0.0 (template) → 1.0.0
- Modified principles: placeholder → 光学一致性与可重复性; placeholder → Agtron 准确度与可校准性; placeholder → 端侧性能与离线优先; placeholder → 隐私与数据最小化; placeholder → 可测试性与可观测性
- Added sections: 核心原则内容, 技术栈与平台约束, 开发流程与质量关卡, 治理
- Removed sections: 无
- Templates: .specify/templates/plan-template.md ✅; .specify/templates/spec-template.md ✅; .specify/templates/tasks-template.md ✅; commands/ ⚠ 不存在（无可更新文件）
- Follow-ups: 无
-->

# Roast Vision 宪章

## 核心原则

### 光学一致性与可重复性
- 拍摄流程必须锁定曝光/白平衡，使用统一光源（推荐 5000K-6500K）和固定距离/角度，界面需给出明确指引。
- 需支持参考色卡或标准咖啡色板的校准入口，记录所用光源、设备型号、曝光参数以便复测。
- 任何算法或 UI 变更不得破坏上述可重复性；如需调整必须同步更新校准指引与测试样本。

### Agtron 准确度与可校准性
- 使用 Agtron 标准色阶输出整点/半点值，默认目标误差 ≤ ±3 Agtron（与校准样本对比）。
- 结果需附带置信度与质量标记（如光照不足、对焦失败），低置信度时必须提示重拍或给出补救操作。
- 必须提供可重复的校准流程（含参考样本、环境要求、计算公式/查表）；所有模型或参数版本要可追溯。

### 端侧性能与离线优先
- 分析全程在端侧完成，单张 1080p 照片目标耗时 ≤ 2s，峰值内存需在计划中量化与验证；网络仅用于可选更新。
- 弱网或离线状态下必须能完成基本测色，需有降级策略（清晰提示、重试、延迟同步）。
- 避免不必要的多次读写或拷贝，图像处理流程需流式或复用缓冲区。

### 隐私与数据最小化
- 默认不上传原始照片；如需上传必须显式二次确认并说明用途；本地存储需加密或置于受限沙盒并支持一键清除。
- 仅请求必需权限（摄像头、可选存储）；权限弹窗文案要说明目的与数据留端策略。
- 日志中不得包含可识别图像；调试样本需脱敏或由用户显式同意。

### 可测试性与可观测性
- 提供固定的样本集与期望 Agtron 值用于回归，测色算法必须是可重复的确定性流程。
- 关键步骤（拍摄、预处理、分割/测色、输出）需可打点/开关，便于 A/B 与性能分析。
- 每个版本需生成校准与性能报告，记录设备、环境、样本、耗时、误差分布。

## 技术栈与平台约束
- 平台：uni-app x（UTS），目标 Android；页面使用 `.uvue`，滚动内容需放入 `scroll-view` 等容器。
- 条件编译：Android 专有逻辑使用 `#ifdef APP-ANDROID`，不得影响其他端的构建。
- 拍摄：使用系统相机/组件，需支持对焦与曝光锁；需保存拍摄元数据以便复测。
- 存储：图片与中间结果存放于应用沙盒，可配置缓存清理策略；不得默认写入公共相册。
- 文档：所有 specs/实施报告使用中文；每次 `speckit.implement` 输出的报告存放于 `specs/{feature-id}/reports/`，文件名 `YYYYMMDD-报告主题.md`。
- 校准：提供参考色卡/标准豆样流程，允许为不同设备生成独立的校准参数。

## 开发流程与质量关卡
- 立项/方案阶段必须完成宪章检查：光学方案（光源/白平衡/曝光锁/距离）、校准流程与 Agtron 目标误差、端侧性能预算与离线策略、权限与隐私策略、可测试性/观测计划。
- 研究与计划需给出性能与内存预算、测试样本清单、设备列表、降级策略，并在实现阶段验证。
- 评审需确认 UI 提示覆盖拍摄姿态、光照、重拍路径；权限文案符合最小化原则。
- 发布前需生成校准与性能报告；实施报告按约定路径与命名落盘。

## 治理
- 宪章优先于其他开发约定，评审必须检验对核心原则的符合性。
- 修订需通过评审并记录版本与生效日期；涉及原则变更需声明影响范围与迁移计划。
- 版本遵循语义化：新增原则或约束为 MINOR，澄清为 PATCH，若修改/移除原则则为 MAJOR。
- 合规性在 PR、预发布与回归阶段检查；发现违反原则的变更必须补充校准与性能验证记录。

**Version**: 1.0.0 | **Ratified**: 2025-12-10 | **Last Amended**: 2025-12-10
