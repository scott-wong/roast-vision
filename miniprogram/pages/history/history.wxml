<!--history.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜å’Œæ“ä½œ -->
  <view class="header">
    <view class="title-section">
      <text class="page-title">å†å²è®°å½•</text>
      <text class="record-count">{{isEmpty ? 'æš‚æ— è®°å½•' : 'å…±' + historyList.length + 'æ¡'}}</text>
    </view>
    <view class="action-buttons" wx:if="{{!isEmpty}}">
      <button type="primary" size="mini" plain bindtap="exportHistory">å¯¼å‡º</button>
      <button type="warn" size="mini" plain bindtap="clearAllHistory">æ¸…ç©º</button>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{isEmpty}}" class="empty-state">
    <text class="empty-icon">ğŸ“­</text>
    <text class="empty-text">è¿˜æ²¡æœ‰æ£€æµ‹è®°å½•</text>
    <text class="empty-hint">å®Œæˆæ£€æµ‹åç‚¹å‡»"ä¿å­˜ç»“æœ"å³å¯ä¿å­˜</text>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view wx:if="{{!isEmpty}}" class="history-list">
    <view
      wx:for="{{historyList}}"
      wx:key="id"
      class="history-item"
    >
      <!-- è®°å½•å¡ç‰‡ -->
      <view class="record-card" bindtap="viewDetail" data-index="{{index}}">
        <!-- æ—¶é—´æ ‡ç­¾ -->
        <view class="time-badge">
          <text class="date">{{item.formattedDate}}</text>
          <text class="time">{{item.formattedTime}}</text>
        </view>

        <!-- ä¸»è¦ä¿¡æ¯ -->
        <view class="record-main">
          <view class="agtron-display">
            <text class="agtron-label">Agtron</text>
            <text class="agtron-value">{{item.agtron}}</text>
          </view>
          
          <view class="record-details">
            <view class="detail-row">
              <text class="detail-label">çƒ˜ç„™åº¦</text>
              <text class="detail-value">{{item.roastLevel}}</text>
            </view>
            <view class="detail-row">
              <text class="detail-label">é¢œè‰²</text>
              <text class="detail-value">{{item.colorDetail}}</text>
            </view>
            <view class="detail-row">
              <text class="detail-label">L*å€¼</text>
              <text class="detail-value">{{item.lStar}}</text>
            </view>
          </view>
        </view>

        <!-- æŸ¥çœ‹æ›´å¤šæç¤º -->
        <view class="view-hint">
          <text>ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ… â€º</text>
        </view>
      </view>

      <!-- åˆ é™¤æŒ‰é’® -->
      <view class="delete-btn" bindtap="deleteRecord" data-index="{{index}}" catchtap="deleteRecord">
        <text>ğŸ—‘ï¸</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨æç¤º -->
  <view wx:if="{{!isEmpty}}" class="footer-hint">
    <text>æœ€å¤šä¿å­˜100æ¡è®°å½•ï¼Œè¶…å‡ºåè‡ªåŠ¨åˆ é™¤æœ€æ—©çš„è®°å½•</text>
  </view>
</view>

