## MODIFIED Requirements

### Requirement: 采样点选择
系统 SHALL 支持用户在图片上点击选择5个采样点（本地检测模式），用于提取颜色值。

#### Scenario: 选择第一个采样点
- **WHEN** 用户在图片上点击位置(x, y)（本地检测模式）
- **THEN** 系统计算点击位置相对于图片的坐标（考虑图片缩放）
- **AND** 系统将显示坐标转换为原始图片的像素坐标
- **AND** 系统在该位置显示采样点标记（带数字的圆圈，从1开始编号）
- **AND** 系统记录该采样点的坐标（相对于容器的显示坐标）
- **AND** 系统从Canvas提取该位置的RGB值并转换为Lab值
- **AND** 系统显示该采样点的Lab值（格式：L*=XX.XX, a*=XX.XX, b*=XX.XX）

#### Scenario: 选择多个采样点
- **WHEN** 用户依次选择5个采样点（本地检测模式）
- **THEN** 系统为每个采样点显示标记（带序号1-5）
- **AND** 系统记录所有采样点的坐标和Lab值
- **AND** 系统在图片上显示提示："请在图片上点击选择采样点 (X/5)"
- **AND** 当选择第5个采样点后，系统自动触发检测结果计算

#### Scenario: 采样点数量限制
- **WHEN** 用户已选择5个采样点（本地检测模式）
- **THEN** 系统禁止继续添加新的采样点
- **AND** 系统显示提示"已选择5个采样点"
- **AND** 系统自动开始计算检测结果（显示"采样完成，正在计算..."提示）

#### Scenario: AI检测模式不显示采样点选择
- **WHEN** 用户选择AI检测模式
- **THEN** 系统不显示采样点选择提示
- **AND** 系统不响应图片上的点击事件（用于选择采样点）
- **AND** 系统显示"开始AI检测"按钮，替代采样点选择流程

### Requirement: 采样点删除
系统 SHALL 支持用户删除已选择的采样点（本地检测模式），重新选择。

#### Scenario: 删除采样点
- **WHEN** 用户点击已存在的采样点标记（显示数字的圆圈，本地检测模式）
- **THEN** 系统删除该采样点及其标记
- **AND** 系统更新已选择的采样点数量
- **AND** 系统清除已计算的检测结果（如果存在）
- **AND** 用户可以重新选择该位置或其他位置

### Requirement: 重新开始检测
系统 SHALL 支持用户清除所有采样点或AI检测状态，重新开始检测流程。

#### Scenario: 清除所有采样点（本地检测模式）
- **WHEN** 用户点击"重新开始"或"重新检测"按钮（本地检测模式）
- **THEN** 系统弹出确认对话框："确定要清除当前检测数据吗？"
- **AND** 用户确认后，系统清除所有已选择的采样点及其标记
- **AND** 系统清除已计算的检测结果
- **AND** 系统重置Canvas状态
- **AND** 系统自动滚动回页面顶部
- **AND** 用户可以重新选择图片或重新选择采样点

#### Scenario: 清除AI检测状态
- **WHEN** 用户点击"重新开始"或"重新检测"按钮（AI检测模式）
- **THEN** 系统弹出确认对话框："确定要清除当前检测数据吗？"
- **AND** 用户确认后，系统清除AI检测结果
- **AND** 系统取消正在进行的上传或检测（如果存在）
- **AND** 系统重置检测状态
- **AND** 系统自动滚动回页面顶部
- **AND** 用户可以重新选择图片并开始新的检测

## ADDED Requirements

### Requirement: 检测模式选择
系统 SHALL 支持用户选择"本地检测"或"AI检测"两种检测模式。

#### Scenario: 模式选择界面
- **WHEN** 用户进入主页面
- **THEN** 系统显示检测模式选择器（选项卡或按钮组）
- **AND** 系统提供两个选项："本地检测"和"AI检测"
- **AND** 默认选择"本地检测"模式（保持现有功能）
- **AND** 用户可以选择切换到"AI检测"模式

#### Scenario: 切换到本地检测模式
- **WHEN** 用户选择"本地检测"模式
- **THEN** 系统清除当前检测状态（如果存在）
- **AND** 系统显示本地检测模式的UI（图片选择、采样点选择提示）
- **AND** 系统启用图片点击选择采样点功能
- **AND** 系统显示"请在图片上点击选择采样点"的提示

#### Scenario: 切换到AI检测模式
- **WHEN** 用户选择"AI检测"模式
- **THEN** 系统清除当前检测状态（如果存在）
- **AND** 系统显示AI检测模式的UI（图片选择、AI检测按钮）
- **AND** 系统禁用图片点击选择采样点功能
- **AND** 系统显示"选择图片后点击开始AI检测"的提示
- **AND** 系统显示AI检测模式的说明（可选）

#### Scenario: 模式切换时清除状态
- **WHEN** 用户在不同检测模式之间切换
- **THEN** 系统清除当前检测状态（采样点、结果、上传状态等）
- **AND** 系统更新UI以匹配选择的模式
- **AND** 系统重置Canvas状态（如果切换到本地检测模式）
- **AND** 用户可以重新选择图片并开始新的检测
